<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>RadioBud</title>
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <!-- Main Window -->
  <div class="window">
    <!-- Titlebar (draggable) -->
    <div class="titlebar">
      <span class="title">RadioBud</span>
      <div class="titlebar-buttons">
        <button id="themeToggle" class="icon-btn">
          <svg class="sun-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
            stroke-width="2">
            <circle cx="12" cy="12" r="5" />
            <line x1="12" y1="1" x2="12" y2="3" />
            <line x1="12" y1="21" x2="12" y2="23" />
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" />
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" />
            <line x1="1" y1="12" x2="3" y2="12" />
            <line x1="21" y1="12" x2="23" y2="12" />
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" />
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" />
          </svg>
          <svg class="moon-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
            stroke-width="2">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" />
          </svg>
        </button>
        <button id="settingsBtn" class="icon-btn">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
            <path
              d="M12 15.5A3.5 3.5 0 0 1 8.5 12 3.5 3.5 0 0 1 12 8.5a3.5 3.5 0 0 1 3.5 3.5 3.5 3.5 0 0 1-3.5 3.5m7.43-2.53c.04-.32.07-.64.07-.97 0-.33-.03-.65-.07-.97l2.11-1.63c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.31-.61-.22l-2.49 1c-.52-.39-1.06-.73-1.69-.98l-.37-2.65A.506.506 0 0 0 14 2h-4c-.25 0-.46.18-.5.42l-.37 2.65c-.63.25-1.17.59-1.69.98l-2.49-1c-.22-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64L4.57 11c-.04.32-.07.65-.07.97 0 .33.03.65.07.97l-2.11 1.66c-.19.15-.25.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1.01c.52.4 1.06.74 1.69.99l.37 2.65c.04.24.25.42.5.42h4c.25 0 .46-.18.5-.42l.37-2.65c.63-.26 1.17-.59 1.69-.99l2.49 1.01c.22.08.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.66z" />
          </svg>
        </button>
      </div>
    </div>

    <!-- Tabs -->
    <div class="tabs">
      <button id="tabRadio" class="tab active">Radio</button>
      <button id="tabFavorites" class="tab">Favourites</button>
      <button id="tabHistory" class="tab">History</button>
    </div>

    <!-- Content Area -->
    <div class="content">
      <!-- Radio Tab -->
      <div id="radioView" class="tab-content active">
        <div class="selector-row">
          <div class="selector">
            <label>Radio</label>
            <select id="radioSelect">
              <option value="somafm">SomaFM</option>
              <option value="nts">NTS Radio</option>
            </select>
          </div>
          <div class="selector">
            <label>Station</label>
            <select id="stationSelect">
              <!-- Populated dynamically by renderer.js -->
            </select>
          </div>
        </div>

        <div id="donationCard" class="donation-card">
          <button id="dismissDonationBtn" class="dismiss-btn" title="Dismiss for this session">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
          <h3>Please consider donating</h3>
          <p>Radios featured on this app are run by real nice people without the support of bigtech but people. If you
            like the station please consider supporting them.</p>
          <div class="donation-links">
            <a href="#" id="somaLink" class="donation-link">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                <polyline points="15 3 21 3 21 9"></polyline>
                <line x1="10" y1="14" x2="21" y2="3"></line>
              </svg>
              Go to Soma.fm's donation page
            </a>
            <a href="#" id="ntsLink" class="donation-link">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                <polyline points="15 3 21 3 21 9"></polyline>
                <line x1="10" y1="14" x2="21" y2="3"></line>
              </svg>
              Go to NTS donation page
            </a>
          </div>
        </div>
      </div>

      <!-- Favorites Tab -->
      <div id="favoritesView" class="tab-content">
        <div id="favoritesContent" class="list-content"></div>
      </div>

      <!-- History Tab -->
      <div id="historyView" class="tab-content">
        <div id="historyContent" class="list-content"></div>
      </div>
    </div>
  </div>

  <!-- Control Bar -->
  <div class="control-bar">
    <button id="playBtn" class="play-btn">
      <svg viewBox="0 0 24 24" fill="currentColor">
        <path d="M8 5v14l11-7z" />
      </svg>
    </button>

    <div id="albumArt" class="album-art">
      <span class="no-art">No Artwork</span>
    </div>

    <div class="song-info">
      <div class="song-title" id="nowPlaying">Select a station</div>
      <div class="song-meta" id="trackMeta"></div>
      <div class="service-links">
        <a id="lastfmLink" class="service-link">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
            <path
              d="M10.584 17.21l-.88-2.392s-1.43 1.594-3.573 1.594c-1.897 0-3.244-1.649-3.244-4.288 0-3.382 1.704-4.591 3.381-4.591 2.419 0 3.188 1.567 3.849 3.574l.88 2.75c.88 2.667 2.524 4.8 7.287 4.8 3.408 0 5.716-1.045 5.716-3.79 0-2.227-1.265-3.381-3.624-3.932l-1.759-.385c-1.21-.275-1.567-.77-1.567-1.595 0-.934.742-1.485 1.952-1.485 1.32 0 2.034.495 2.145 1.677l2.749-.33c-.22-2.474-1.924-3.492-4.729-3.492-2.474 0-4.893.935-4.893 3.932 0 1.87.907 3.052 3.188 3.546l1.869.44c1.402.33 1.869.907 1.869 1.704 0 1.017-.99 1.43-2.86 1.43-2.776 0-3.932-1.457-4.591-3.464l-.907-2.75c-1.155-3.573-2.997-4.893-6.653-4.893C2.144 5.333 0 7.89 0 12.233c0 4.18 2.144 6.434 5.993 6.434 3.106 0 4.591-1.457 4.591-1.457z" />
          </svg>
        </a>
        <a id="bandcampLink" class="service-link">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
            <path d="M0 18.75l7.437-13.5h16.563l-7.438 13.5z" />
          </svg>
        </a>
        <a id="youtubeLink" class="service-link">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
            <path
              d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z" />
          </svg>
        </a>
      </div>
    </div>

    <button id="starBtn" class="star-btn">☆</button>

    <div class="volume-control">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
        <path
          d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z" />
      </svg>
      <input type="range" id="volumeSlider" min="0" max="100" value="100">
    </div>
  </div>

  <!-- Update Notification Modal -->
  <div id="updateModal" class="modal" style="display: none;">
    <div class="modal-content">
      <h3 id="updateTitle">Update Available</h3>
      <p id="updateMessage">A new version is available. Would you like to download it?</p>
      <div id="updateProgress" class="update-progress" style="display: none;">
        <div class="progress-bar">
          <div id="progressFill" class="progress-fill"></div>
        </div>
        <span id="progressText">Downloading...</span>
      </div>
      <div class="modal-buttons">
        <button id="updateLaterBtn" class="modal-btn secondary">Later</button>
        <button id="updateNowBtn" class="modal-btn primary">Download</button>
        <button id="restartBtn" class="modal-btn primary" style="display: none;">Restart Now</button>
      </div>
    </div>
  </div>

  <!-- Settings Modal -->
  <div id="settingsModal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Settings</h3>
        <button id="closeSettingsModal" class="modal-close">×</button>
      </div>
      <div class="settings-content">
        <div class="settings-section">
          <h4>About</h4>
          <p class="settings-info">RadioBud v<span id="appVersion">0.4.1</span></p>
          <p class="settings-info-small">A desktop radio app for streaming SomaFM and NTS Radio</p>
        </div>
        <div class="settings-section">
          <h4>Updates</h4>
          <button id="checkUpdatesBtn" class="settings-btn">Check for Updates</button>
          <p id="updateStatus" class="settings-info-small"></p>
        </div>
      </div>
    </div>
  </div>

  <!-- Butterchurn Visualizer Overlay -->
  <div id="visualizerOverlay" class="visualizer-overlay" style="display: none;">
    <canvas id="visualizerCanvas"></canvas>

    <!-- Top-right Controls -->
    <div class="visualizer-top-controls">
      <!-- Options Panel -->
      <div id="visualizerOptions" class="visualizer-options">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
          <path
            d="M12 15.5A3.5 3.5 0 0 1 8.5 12 3.5 3.5 0 0 1 12 8.5a3.5 3.5 0 0 1 3.5 3.5 3.5 3.5 0 0 1-3.5 3.5m7.43-2.53c.04-.32.07-.64.07-.97 0-.33-.03-.65-.07-.97l2.11-1.63c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.31-.61-.22l-2.49 1c-.52-.39-1.06-.73-1.69-.98l-.37-2.65A.506.506 0 0 0 14 2h-4c-.25 0-.46.18-.5.42l-.37 2.65c-.63.25-1.17.59-1.69.98l-2.49-1c-.22-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64L4.57 11c-.04.32-.07.65-.07.97 0 .33.03.65.07.97l-2.11 1.66c-.19.15-.25.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1.01c.52.4 1.06.74 1.69.99l.37 2.65c.04.24.25.42.5.42h4c.25 0 .46-.18.5-.42l.37-2.65c.63-.26 1.17-.59 1.69-.99l2.49 1.01c.22.08.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.66z" />
        </svg>
        <span id="openSettingsBtn">Visualiser Options</span>
      </div>
      <!-- Close Button -->
      <button id="closeVisualizer" class="visualizer-close-btn">
        <span>×</span>
      </button>
    </div>

    <!-- Settings Popover (center) -->
    <div id="settingsPopover" class="settings-popover" style="display: none;">
      <div class="settings-popover-header">
        <div class="settings-tabs">
          <button id="tabOptions" class="settings-tab active">Options</button>
          <button id="tabPresets" class="settings-tab">Presets</button>
        </div>
        <button id="closeSettingsBtn" class="close-settings">×</button>
      </div>

      <!-- Options Tab Content -->
      <div id="optionsTabContent" class="settings-tab-content active">
        <div class="settings-popover-content">
          <!-- FPS Control -->
          <div class="settings-group">
            <label>Frame Rate</label>
            <div class="fps-buttons">
              <button id="fps24Popup" class="fps-btn-popup active">24</button>
              <button id="fps30Popup" class="fps-btn-popup">30</button>
              <button id="fps60Popup" class="fps-btn-popup">60</button>
            </div>
          </div>

          <!-- Shuffle Preset Toggle -->
          <div class="settings-group">
            <label class="toggle-label">
              <input type="checkbox" id="shuffleToggle" checked>
              <span>Shuffle Preset</span>
            </label>
          </div>

          <!-- Shuffle Timer Slider -->
          <div class="settings-group">
            <label>Shuffle Timer</label>
            <div class="slider-control">
              <input type="range" id="shuffleTimerSlider" min="1" max="10" value="1" class="shuffle-slider">
              <span id="shuffleTimerValue" class="slider-value">1 min</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Presets Tab Content -->
      <div id="presetsTabContent" class="settings-tab-content">
        <div class="preset-search-container">
          <input type="text" id="presetSearch" class="preset-search" placeholder="Search presets...">
        </div>
        <div id="presetList" class="preset-list"></div>
      </div>
    </div>

    <!-- Bottom-left Info Panel -->
    <div id="visualizerInfoPanel" class="visualizer-info-panel">
      <div id="visualizerAlbumArt" class="visualizer-album-art">
        <span class="no-artwork-small">—</span>
      </div>
      <div class="visualizer-song-info">
        <div id="visualizerSongTitle" class="visualizer-song-title">RadioBud Visualizer</div>
        <div class="visualizer-preset-info">
          <span id="presetArtist" class="visualizer-preset-artist"></span>
          <button id="favoritePresetBtn" class="favorite-preset-btn" title="Favorite this preset">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path
                d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z" />
            </svg>
          </button>
        </div>
      </div>
      <div class="visualizer-help">← → to change preset, R for random</div>
    </div>

    <!-- Favorite Heart Animation -->
    <div id="favoriteHeartAnimation" class="favorite-heart-animation" style="display: none;">
      <svg width="60" height="60" viewBox="0 0 24 24" fill="currentColor">
        <path
          d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z" />
      </svg>
    </div>
  </div>

  <script src="renderer.js"></script>
</body>

</html>